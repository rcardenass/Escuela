// Copyright 2001, 2003 InterAKT Online. All rights reserved.

if (typeof HTMLElement!="undefined" && ! HTMLElement.prototype.insertAdjacentElement) {

	HTMLElement.prototype.insertAdjacentElement = function (where,parsedNode) {
		switch (where){
			case 'beforeBegin':
				this.parentNode.insertBefore(parsedNode,this)
				break;
			case 'afterBegin':
				this.insertBefore(parsedNode,this.firstChild);
				break;
			case 'beforeEnd':
				this.appendChild(parsedNode);
				break;
			case 'afterEnd':
				if (this.nextSibling) this.parentNode.insertBefore(parsedNode,this.nextSibling);
				else this.parentNode.appendChild(parsedNode);
			break;
		}
	}

	HTMLElement.prototype.insertAdjacentHTML = function (where,htmlStr) {
		var r = this.ownerDocument.createRange();
		r.setStartBefore(this);
		var parsedHTML = r.createContextualFragment(htmlStr);
		this.insertAdjacentElement(where,parsedHTML)
	}

	HTMLElement.prototype.insertAdjacentText = function (where,txtStr) {
		var parsedText = document.createTextNode(txtStr)
		this.insertAdjacentElement(where,parsedText)
	}
}


var secbfuXoiTXI = 38; var WiDcqnyEuPq = 40; var PbDWBInVuSB = 37; var QSABTmcdpGCi = 39; var iWDbGksDuqG = 33; var dvOnzIbGSEHz = 34; var lRDUqJKbujq = 36; var pKrNzKBsPdA = 35; var SbxtmDRnpGCB = 13; var xRksLHTYyEHz = 46; var pKrZZgdRpGK = 8; var pKrjZrKBsiOy = 9; var pKrjKBsPiP = 27; window.to = new Array(); function moveXbySlicePos (x, img) { if (!document.layers) { var NPbPiQqbMKKZ = navigator.platform ? navigator.platform == "Win32" : false; var LFKRRWmkCpkB = document.all && !NPbPiQqbMKKZ && getExplorerVersion() >= 4.5; var par = img; var AMzBokMfEnvp = 0; while(par){ if( par.leftMargin && ! NPbPiQqbMKKZ ) x += parseInt(par.leftMargin); if( (par.offsetLeft != AMzBokMfEnvp) && par.offsetLeft ) x += parseInt(par.offsetLeft); if( par.offsetLeft != 0 ) AMzBokMfEnvp = par.offsetLeft; par = LFKRRWmkCpkB ? par.parentElement : par.offsetParent; } } else if (img.x) x += img.x; return x; } function moveYbySlicePos (y, img) { if(!document.layers) { var NPbPiQqbMKKZ = navigator.platform ? navigator.platform == "Win32" : false; var LFKRRWmkCpkB = document.all && !NPbPiQqbMKKZ && getExplorerVersion() >= 4.5; var par = img; var AMzBokMfEnvp = 0; while(par){ if( par.topMargin && !NPbPiQqbMKKZ ) y += parseInt(par.topMargin); if( (par.offsetTop != AMzBokMfEnvp) && par.offsetTop ) y += parseInt(par.offsetTop); if( par.offsetTop != 0 ) AMzBokMfEnvp = par.offsetTop; par = LFKRRWmkCpkB ? par.parentElement : par.offsetParent; } } else if (img.y >= 0) y += img.y; return y; } function di_drawRange(sel, NUghURlDXXp, EIntOJwkuJpF, NAiMUjTsvnEg) { var j=0; for(var i=EIntOJwkuJpF; j<NAiMUjTsvnEg && i*2<NUghURlDXXp.length; i++) { if(sel.options[j]){ sel.options[j].text = NUghURlDXXp[i*2]; sel.options[j].value = NUghURlDXXp[i*2-1]; } else { sel.options[sel.options.length] = new Option(NUghURlDXXp[i*2], NUghURlDXXp[i*2-1]); } j++; } } function di_openSelect(el) { var sel = el.sel; el.addButton.disabled = true; var NUghURlDXXp = eval("window." + el.NUghURlDXXp); sel.virtualStart = 1; di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); di_syncSelection(el, true); var pos = new Object(); pos.x = moveXbySlicePos(0, el); pos.y = moveYbySlicePos(el.offsetHeight, el); sel.style.left = pos.x + "px"; sel.style.top = pos.y + "px"; sel.style.display='block'; pos.x = moveXbySlicePos(0, el); pos.y = moveYbySlicePos(el.offsetHeight, el); sel.style.left = pos.x + "px"; sel.style.top = pos.y + "px"; sel.style.display='none'; setTimeout(function() { sel.style.top = parseInt(sel.style.top) + 1 + "px"; sel.style.display = "block"; }, 10); } function di_syncWithSelection(el) { if(el.sel.selectedIndex == -1) { return; } di_setAddDisabled(el, true); el.value = el.sel.options[el.sel.selectedIndex].text; if (el.edittype == 'E') { el.hidden.value = el.sel.options[el.sel.selectedIndex].value; } else { el.hidden.value = el.sel.options[el.sel.selectedIndex].text; } var PGIVvZqwXNYO = el.value.length; if(el.setSelectionRange) { el.setSelectionRange(PGIVvZqwXNYO, PGIVvZqwXNYO); } else if (el.createTextRange) { var BXMAGqKQYXNp = el.createTextRange(); BXMAGqKQYXNp.moveStart('character', PGIVvZqwXNYO); BXMAGqKQYXNp.moveEnd('character', PGIVvZqwXNYO); BXMAGqKQYXNp.select(); } } function di_setAddDisabled(el, dis) { if(el.edittype == 'S') { return; } el.addButton.disabled = dis; } function di_syncSelection(el, nwfAOAPWYGnq) { if (!el.NUghURlDXXp) { di_initialize(el.id.replace(/_edit$/, '')); } var cXyVWvleMnDn = el.value; var sel = el.sel; if(cXyVWvleMnDn.length == 0) { di_setAddDisabled(el, true); return; } var NUghURlDXXp = eval("window." + el.NUghURlDXXp); var NPqzyYIqDuFI = -1; for (var i=2; i<NUghURlDXXp.length;i+=2) { if ((NUghURlDXXp[i].toLowerCase()).indexOf(cXyVWvleMnDn.toLowerCase())==0) { NPqzyYIqDuFI = i/2; break; } } if(NPqzyYIqDuFI>0 && NUghURlDXXp[NPqzyYIqDuFI*2].length == cXyVWvleMnDn.length) { di_setAddDisabled(el, true); } else { di_setAddDisabled(el, false); } if (el.edittype != 'E') { el.hidden.value = el.value; } if(NPqzyYIqDuFI != -1 && el.edittype == 'E') { el.hidden.value = NUghURlDXXp[NPqzyYIqDuFI*2-1]; } if(nwfAOAPWYGnq && cXyVWvleMnDn.length==0) { NPqzyYIqDuFI = 0; } if(NPqzyYIqDuFI < sel.virtualStart-1 || NPqzyYIqDuFI >= sel.virtualStart + el.norec-1) { var tmp = NPqzyYIqDuFI - Math.floor(el.norec/2) + 1; if(tmp < 1) { sel.virtualStart = 1; } else if(tmp+el.norec-1 > (NUghURlDXXp.length-1)/2) { sel.virtualStart = (NUghURlDXXp.length-1)/2-el.norec+1; NPqzyYIqDuFI = el.norec -((NUghURlDXXp.length-1)/2 - NPqzyYIqDuFI) -1; } else { sel.virtualStart = tmp; NPqzyYIqDuFI = Math.floor(el.norec/2); } di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); } else { NPqzyYIqDuFI -= sel.virtualStart; } try { sel.selectedIndex = NPqzyYIqDuFI; if(sel.selectedIndex != NPqzyYIqDuFI) { di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); sel.selectedIndex = NPqzyYIqDuFI; } } catch (e) { alert("first: " + NPqzyYIqDuFI); } } function di_onBlur(el, XSynZKhcvnYy) { window.to[el.id] = setTimeout('di_closeList("'+el.id+'")', 100); } function di_inputKeyDown(el, XSynZKhcvnYy) { var ds = el.name.substr(0, el.name.length-5); if (!el.NUghURlDXXp) { di_initialize(ds); } var sel = el.sel; switch (XSynZKhcvnYy.keyCode) { case pKrjKBsPiP: case pKrjZrKBsiOy: if(sel.style.display == 'block') { if(sel.selectedIndex != -1){ di_syncWithSelection(el); } di_closeList(el.id); } return true; case SbxtmDRnpGCB: if(sel.selectedIndex != -1){ di_syncWithSelection(el); } if(sel.style.display == 'block') { di_closeList(el.id); XSynZKhcvnYy.cancelBubble = true; if (XSynZKhcvnYy.stopPropagation) XSynZKhcvnYy.stopPropagation(); return false; } else { return true; } case WiDcqnyEuPq: if(sel.style.display == 'none') { di_openSelect(el); } else { di_listIncrementSel(el); di_syncWithSelection(el); } break; case secbfuXoiTXI: if(sel.style.display == 'block') { di_listDecrementSel(el); di_syncWithSelection(el); } break; case iWDbGksDuqG: if(sel.style.display == 'block') { di_listDecrementSel(el, 5); di_syncWithSelection(el); } break; case dvOnzIbGSEHz: if(sel.style.display == 'block') { di_listIncrementSel(el, 5); di_syncWithSelection(el); } break; } return true; } function di_initialize(ds) { var el = document.getElementById(ds + '_edit'); if (!el.NUghURlDXXp) { el.NUghURlDXXp = ds + "_el"; el.norec = parseInt(eval(ds + "_norec")); el.edittype = eval(ds + "_edittype"); el.altstyle = eval(ds + "_style"); el.restrict = eval(ds + "_restrict"); el.addButton = document.getElementById(ds + "_add"); el.hidden = document.getElementById(ds); di_sortDatasource(eval('window.' + el.NUghURlDXXp)); } if (!el.sel) { text = '<SELECT tabindex="-1" name='+ds+'_sel id='+ds+'_sel size=5 style="position:absolute; display:none;'+el.altstyle+'"' + 'onFocus="di_listFocused(this.el)"'+ 'onDblClick="di_listDblClicked(this.el)"'+ 'onMouseUp="di_listClicked(this.el)">'+ '</SELECT>'; document.body.insertAdjacentHTML("beforeEnd", text); el.sel = document.getElementById(ds + "_sel"); el.addButton = document.getElementById(ds + "_add"); el.iframe = document.getElementById(ds + "_iframe"); el.addButton.el = el; el.sel.el = el; el.sel.style.left = moveXbySlicePos(0, el); el.sel.style.top = moveYbySlicePos(22, el); if (el.sel.style.pixelWidth) { el.sel.style.pixelWidth += 19; } } } function di_buttonPressed(zpnAGIQcEEHO) { var el = document.getElementById(zpnAGIQcEEHO + '_edit'); if (!el.NUghURlDXXp) { di_initialize(zpnAGIQcEEHO); } var sel = el.sel; if(sel.style.display == 'none') { di_openSelect(el); } else { di_closeList(el.id); } } function di_addElement(bt, rp, id, vANLkTuDiXwX) { el = bt.el; var sw = false; if (bt.shouldNotAsk || vANLkTuDiXwX=='') { sw = true; bt.shouldNotAsk = false; } else { vANLkTuDiXwX = vANLkTuDiXwX.replace("%s", el.value); sw = confirm(vANLkTuDiXwX); } if (sw) { el.iframe.src = rp + "includes/widgets/dynamicInputP.php" + "?el=" + el.id + "&id=" + id + "&text=" + escape(el.value); } } function di_sortDatasource(NUghURlDXXp) { var sw = true; var n = NUghURlDXXp.length; while (sw) { sw = false; for (var i=1;i<=n-2;i+=2) { if (NUghURlDXXp[i+1] > NUghURlDXXp[i+3]) { sw = true; var tmp = NUghURlDXXp[i+1]; NUghURlDXXp[i+1] = NUghURlDXXp[i+3]; NUghURlDXXp[i+3] = tmp; tmp = NUghURlDXXp[i]; NUghURlDXXp[i] = NUghURlDXXp[i+2]; NUghURlDXXp[i+2] = tmp; } } n -= 2; } } function di_closeList(zpnAGIQcEEHO) { var el = document.getElementById(zpnAGIQcEEHO); var sel = el.sel; if (sel) { if(el.edittype == 'S') { el.hidden.value = el.value; } else { if(sel.options.length > 0) { if (sel.selectedIndex>=0) { el.hidden.value = sel.options[sel.selectedIndex].value; di_setAddDisabled(el, true); } else { if (el.restrict == 'Yes') { NUghURlDXXp = eval("window." + el.NUghURlDXXp); el.value = NUghURlDXXp[2]; el.hidden.value = NUghURlDXXp[1]; di_setAddDisabled(el, true); } else { el.hidden.value = -1; di_setAddDisabled(el, false); } } } else { if (el.restrict == 'Yes') { di_setAddDisabled(el, true); } else { if(el.value.length != 0) { el.hidden.value = -1; di_setAddDisabled(el, false); } } } } sel.style.display='none'; } } function di_vFocused(XwXGvjvgEtkY) { var el = document.getElementById(XwXGvjvgEtkY + '_edit'); clearTimeout(window.to[el.id]); el.focus(); } function di_listFocused(el) { clearTimeout(window.to[el.id]); el.focus(); } function di_listClicked(el) { di_syncWithSelection(el); } function di_listDblClicked(el) { di_closeList(el.id); } function di_listIncrementSel(el, rxjhRZGdJwKO) { if(!rxjhRZGdJwKO) { rxjhRZGdJwKO = 1; } var sel = el.sel; if(sel.selectedIndex < el.norec-rxjhRZGdJwKO) { sel.selectedIndex += rxjhRZGdJwKO; } else { var NUghURlDXXp = eval("window." + el.NUghURlDXXp); if((sel.virtualStart-1) + el.norec + rxjhRZGdJwKO <= (NUghURlDXXp.length-1)/2) { sel.virtualStart += rxjhRZGdJwKO; di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); } else if((sel.virtualStart-1) + el.norec < (NUghURlDXXp.length-1)/2) { sel.virtualStart = (NUghURlDXXp.length-1)/2 - el.norec + 1; di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); sel.selectedIndex = el.norec-1; } else { sel.selectedIndex = el.norec-1; } } } function di_listDecrementSel(el, rxjhRZGdJwKO) { if(!rxjhRZGdJwKO) { rxjhRZGdJwKO = 1; } var sel = el.sel; if(sel.selectedIndex >= 0 + rxjhRZGdJwKO) { sel.selectedIndex -= rxjhRZGdJwKO; } else { var NUghURlDXXp = eval("window." + el.NUghURlDXXp); if(sel.virtualStart > rxjhRZGdJwKO) { sel.virtualStart-= rxjhRZGdJwKO; di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); } else if(sel.virtualStart >1) { sel.virtualStart = 1; di_drawRange(sel, NUghURlDXXp, sel.virtualStart, el.norec); sel.selectedIndex = 0; } else { sel.selectedIndex = 0; } } } function di_updateForm(bt) { bt = document.getElementById(bt); if (!bt.form.btns) { bt.form.btns = new Array(); } bt.form.btns[bt.form.btns.length] = bt; if (!bt.form.onsubmit) { bt.form.onsubmit = di_checkSubmit; } } function di_checkSubmit() { var sw = true; for (i in this.btns) { if (!this.btns[i].disabled) { sw = false; } } if (sw) { return true; } setTimeout("di_checkSubmit1('" + this.btns[0].id + "')", 1); return sw; } function di_checkSubmit1(IbglBwEBQEpO) { btn = document.getElementById(IbglBwEBQEpO); if (confirm(dynImp_submittext)) { for (i in btn.form.btns) { if (!btn.form.btns[i].disabled) { btn.form.btns[i].shouldNotAsk = true; if (btn.form.btns[i].fireEvent) { btn.form.btns[i].fireEvent('onclick'); } else { var XSynZKhcvnYy = document.createEvent("MouseEvents"); XSynZKhcvnYy.initMouseEvent("click", 1, 1, window, 1, 10, 50, 10, 50, 0, 0, 0, 0, 1, btn.form.btns[i]); btn.form.btns[i].dispatchEvent(XSynZKhcvnYy); } } } setTimeout("di_checkSubmit2('" + btn.form.btns[0].id + "')", 100); } } function di_checkSubmit2(IbglBwEBQEpO) { btn = document.getElementById(IbglBwEBQEpO); var sw = true; var i; for (i in btn.form.btns) { if (!btn.form.btns[i].disabled) { sw = false; } } if (sw) { for (i=0;i<btn.form.elements.length;i++) { if (btn.form.elements[i].tagName == 'INPUT') { if (btn.form.elements[i].type == 'submit') { btn.form.elements[i].click(); return; } } } } else { setTimeout("di_checkSubmit2('" + IbglBwEBQEpO + "')", 100); } } function autoComplete (nldRqkWZnnHL, evt) { if(evt.keyCode == SbxtmDRnpGCB) { return; } if (evt.keyCode == pKrZZgdRpGK || evt.keyCode == xRksLHTYyEHz) { nldRqkWZnnHL.exValue = nldRqkWZnnHL.value; di_syncSelection(nldRqkWZnnHL); return; } if (evt.keyCode == secbfuXoiTXI || evt.keyCode == QSABTmcdpGCi || evt.keyCode == WiDcqnyEuPq || evt.keyCode == PbDWBInVuSB || evt.keyCode == iWDbGksDuqG || evt.keyCode == dvOnzIbGSEHz) { return; } if (nldRqkWZnnHL.exValue && nldRqkWZnnHL.exValue == nldRqkWZnnHL.value) { return; } di_syncSelection(nldRqkWZnnHL); if (!nldRqkWZnnHL.NUghURlDXXp) { nldRqkWZnnHL.id = nldRqkWZnnHL.name; nldRqkWZnnHL.NUghURlDXXp = nldRqkWZnnHL.name.substr(0, nldRqkWZnnHL.name.langth-5) + "_el"; } dataArray = eval("window." + nldRqkWZnnHL.NUghURlDXXp); var QzBgtUIqDuJp = false; for (var i = 1; i < dataArray.length; i+=2) { if ((QzBgtUIqDuJp = dataArray[i+1].toLowerCase().indexOf(nldRqkWZnnHL.value.toLowerCase()) == 0)) { break; } } if (QzBgtUIqDuJp) { var nApIRvlYNnAM = nldRqkWZnnHL.value; if (typeof nldRqkWZnnHL.selectionStart != 'undefined') { if (evt.keyCode == 16) { return; } nldRqkWZnnHL.value = dataArray[i+1]; nldRqkWZnnHL.setSelectionRange(nApIRvlYNnAM.length, nldRqkWZnnHL.value.length); } else if (nldRqkWZnnHL.createTextRange) { if (evt.keyCode == 16) { return; } nldRqkWZnnHL.value = dataArray[i+1]; var BXMAGqKQYXNp = nldRqkWZnnHL.createTextRange(); BXMAGqKQYXNp.moveStart('character', nApIRvlYNnAM.length); BXMAGqKQYXNp.moveEnd('character', nldRqkWZnnHL.value.length); BXMAGqKQYXNp.select(); } else { if (confirm("Are you looking for '" + dataArray[i+1] + "'?")) { nldRqkWZnnHL.value = dataArray[i+1]; } } } nldRqkWZnnHL.exValue = nldRqkWZnnHL.value; } 